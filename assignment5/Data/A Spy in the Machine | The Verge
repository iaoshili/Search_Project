{"Main text":"A Spy in the Machine\nHow a brutal government used cutting-edge spyware to hijack one activist's life\nBy Amar Toor & Russell Brandom\nIn November 2005, during the dead of night, five black cars pulled up in front of the home of Moosa Abd-Ali Ali. The doors opened, and a group of men stepped out. They could\u2019ve been officers, or maybe they were just hired muscle \u2014 such distinctions aren\u2019t always clear in Bahrain. But Moosa knew they were sent by the government, and they had come for him.\nMoosa was just 24 at the time, but he had already become a prominent anti-government activist within the small kingdom of Bahrain. He\u2019d spent years protesting for equal employment rights and had been jailed and tortured on several occasions. When the cars pulled up outside his home that night, he had just served a nine-month prison sentence on charges that were never revealed to him.\nThe men barged into Moosa\u2019s house and dragged him out into the streets of Al-Akar, the seaside village where he lived with his wife and young son. They took him to a quiet, darkened alleyway and took turns beating him. Then they raped him. If he didn\u2019t stop his activism, they told him, they would do the same to his family.\nMoosa didn\u2019t leave his house for a week after the assault. On December 21st, 2005, he fled for London, after narrowly sliding by Bahraini security forces at the airport. \"If I stayed in Bahrain I would have died in prison,\" he says. \"I am sure of it.\"\nHe hasn\u2019t been home since.\nHis torturers were now thousands of miles away. Or so he thought\nMoosa became an activist at the age of 14, when he saw one of his favorite teachers being carried away in handcuffs by a group of policemen. He was politically naive at the time, but the teacher\u2019s arrest lit a fire. Days later, he joined his very first protest \u2014 an act for which he was held at gunpoint in his home and sent to jail for five months.\nNow 33, Moosa has spent most of his life campaigning for democracy and equal rights in Bahrain, a Middle East island nation of 1.3 million that has been ruled by the Khalifa family dynasty for more than 200 years. He\u2019s been jailed seven times \u2014 \"Not a small number,\" he says \u2014 and has endured brutal torture and assault at the hand of Bahraini officials.\nBahrain\u2019s government has a long and dubious human rights record, especially when it comes to free speech. Even the smallest forms of dissent are regularly met with severe punishment, and the crackdown has only intensified following the Arab Spring uprisings of 2011. This month, a prominent activist was sentenced to six months in prison over tweets that were critical of the country\u2019s defense and interior ministries. Bahrain has also been a longtime ally of the United States and particularly the UK, a relationship the kingdom has maintained despite ongoing unrest.\nThat\u2019s why Moosa fled to London. If he couldn\u2019t continue fighting from within Bahrain, he could at least do it from Bahrain\u2019s closest and historically most important global partner. (Bahrain was effectively a British protectorate until 1971.) He was granted asylum in 2006, his wife and child joined him a year later, and for a while, it seemed as if he was finally safe.\nHe found a job as a cameraman for a Bahraini news agency and embedded himself within London\u2019s community of exiled activists. He was definitely still on the Bahraini government\u2019s radar \u2014 his high-profile demonstrations and sizable social media following made sure of it \u2014 but he was finally free to protest, and his torturers were now thousands of miles away. Or so he thought.\nOne day in 2011, Moosa opened the Facebook Messenger app on his iPhone. What he saw was chilling: someone else typing under his name to an activist friend of his in Bahrain. Whoever it was kept posing personal questions prodding for information, and Moosa watched unfold right before eyes. He panicked.\n\"It was like, \u2018What\u2019s going on? What\u2019s happening?\u2019\" he recalls. He changed his password, alerted his friend, and stopped using Facebook Messenger \u2014 but the intrusions kept coming.\nIn another instance, Moosa noticed that someone posing as him solicited his female Facebook friends for sex \u2014 part of an effort, it seemed, to blackmail or perhaps defame him in Bahrain\u2019s conservative media. Facebook was only the beginning. Unbeknownst to him, Moosa\u2019s phone and computer had been infected with a highly sophisticated piece of spyware, built and sold in secret. The implant effectively commandeered his digital existence, collecting everything he did or said online.\nThe implant effectively commandeered his digital existence\nUpon his arrival in London, Moosa had become an unofficial archivist for his activist community, obsessively documenting every protest and broadcasting his videos to a large group of YouTube followers. Whenever something happened back in Bahrain, he\u2019d receive a flurry of images and video footage from contacts and disseminate the content online and to media outlets. Now, whoever was behind the hack had access to all of his accounts, emails, documents, and a massive trove of videos. They could even control his computer\u2019s webcam and microphone.\nAn investigation would later reveal that Moosa\u2019s online life was hijacked for eight months. All signs pointed to Bahrain as the culprit, and FinFisher, a mysterious spyware for-hire tool, as the weapon of choice.\nIt was May of 2012 when Morgan Marquis-Boire first got the package from Bahrain. He was working on Google\u2019s incident response team at the time, protecting high-risk users from state-sponsored attackers. (He has since become security director for First Look Media.) Along the way, he\u2019d seen a lot of spyware being sent after protesters during the Arab Spring. Most of the implants he ran into were easy to spot and remove. But this one, arriving in a protected attachment from BahrainWatch, seemed more complicated. Following standard procedure, Marquis-Boire set the program running in a virtual machine, essentially a fish tank where he could watch the virus at work. He watched the virtual machine\u2019s working memory, keeping his eye on the software as it stretched its legs in the new environment.\n\"Holy shit, I think this is FinFisher!\"\nThen, without warning, the implant disappeared. That got Marquis-Boire\u2019s attention. \"I thought, \u2018Oh we have a player here,\u2019\" he recalls.\nIt was a sign of a more sophisticated author at work. The implant used a technique called process-hollowing \u2014 injecting its own code into a program that\u2019s still running in order to use the legitimate program as cover. Digging through the working memory, Marquis-Boire found the implant hiding in \"winlogon.exe,\" and he could see the new files that had rushed in to replace the old ones. One line of code stuck out, left over from a file path on the implant developer\u2019s computer:\ny:\\lsvn_branches\\finspyv4.01\\finspyv2\\src\\libs\\libgmp\\mpn-tdiv_qr.c\n\"I thought, Finspy, that rings some bells,\" Marquis-Boire recalls. \"Holy shit, I think this is FinFisher!\"\nFinFisher had become a kind of bogeyman in the security community since brochures advertising the software\u2019s capabilities popped up in a Wikileaks drop in December of 2011. FinFisher could purportedly empower its owner with the kinds of advanced intrusion techniques usually reserved for the NSA. \"There was a certain amount of interest just because no one had seen it,\" Marquis-Boire says. \"All we had were these leaked documents.\"\nThe cover page of a FinFisher document released by Wikileaks.\nFinFisher was created and sold by Gamma International, an international surveillance company with offices in London and Frankfurt. The Gamma brochures promised remote monitoring and keylogging \u2014 they even said they could listen in on a target\u2019s Skype calls in real time. It\u2019s the kind of technology that could be subject to international export restrictions like the Wassenaar Arrangement, so finding it in the hands of the Bahraini government would have major diplomatic consequences. But so far, no one had been able to pin down the program in action. When Arab Spring protestors found evidence of FinFisher use by the Mubarak government in Egypt, Gamma simply said the software had been stolen. No one was ever able to prove otherwise.\nBut now Marquis-Boire had caught a FinFisher sample in the wild, and thanks to the leaked brochures, he had a roadmap of everything the implant could do. The implant divided its tasks between different modules, like a crew of bank-robbers: one module would break through a device\u2019s security and then deploy another module to log keystrokes, collecting the target\u2019s passwords. A third module took screenshots of the desktop, catching anything the subject might be looking at. A fourth module encrypted the data into a unique file format, so anyone looking through a hard drive wouldn\u2019t notice the device was recording anything. Once the data was safely encrypted, the implant would send the file back home to its command server \u2014 in this case, a server at Bahrain\u2019s national telecom.\nMarquis-Boire enlisted the aid of Claudio Guarnieri, a researcher at security firm Rapid7, to further explore the software. The two uncovered a mobile version of the implant, which came in different versions for iOS, Android, and even Symbian, like a hot startup trying to cover as much of the market as possible. The new platform enabled dangerous new features like tracking targets through GPS and pulling contacts directly from the phone\u2019s memory. There were specific modules for popular chat and VOIP apps like WhatsApp and Viber, in case you tried to escape by running to a third-party service. It could even activate the on-board microphone to listen in from your pocket. Once the implant was installed, your phone effectively became an enemy agent. \"I\u2019d be working at my computer and start squinting at my phone, thinking, maybe I should turn that off,\" Marquis-Boire says. \"It produced this weird dissonance between me and this device that I carry around all the time.\"\nThe implant divided its tasks between different modules like a crew of bank-robbers\nThen there were the command servers themselves. After studying the implant, Marquis-Boire and the others were able to recreate the fingerprint it used when it phoned home to the command server, which gave them a new way to catch FinFisher in the act. Why not send the ping into the wild and see how many servers answered? If it worked, it would show them all the FinFisher installations running on the open web.\nBut finding that out meant sending out a ping to billions of IP addresses at once \u2014 which also meant finding an extremely understanding traffic provider. \"I remember telling providers, \u2018I want a big box with a lot of bandwidth,\u2019\" Marquis-Boire says. Most assumed he wanted it for criminal purposes, rather than to catch hackers in the act. \"We finally found a provider that I was able to explain it to, and they still accidentally shut down the box halfway through.\" After a few false starts, the pings finally went out and the team waited to see what would come back.\nInstead of a few outposts, they found an army. FinFisher\u2019s agents were everywhere: Japan, Germany, India, Serbia, Mongolia \u2014 there were even servers in the US. It was an atlas of personal invasions. All told, 25 countries hosted a server of some kind, each hired out to a different regime and pointing the x-ray at a different enemy of the state.\nBut while he could see FinFisher\u2019s control servers, Marquis-Boire still couldn\u2019t see who they were working for. One server was on the official government grid of Turkmenistan, which made it easy enough to guess who put it there \u2014 but who was behind the for-hire servers in the US? When they listened in, who did they hear? The web is a busy place, and it keeps many secrets. A scan can\u2019t dig up all of them.\nGamma's advertised capabilities, from Gammagroup.com\nMarquis-Boire published the work in a series of three landmark papers from July 2012 to March of 2013, each titled with a cheeky Bond pun like  \" The Smartphone Who Loved Me \" or \" You Only Click Twice .\" The papers laid out everything he knew about FinFisher\u2019s network, revealing a global surveillance network that was being hired out to some of the world\u2019s most repressive governments. Targeted exploits weren\u2019t just for the NSA anymore. They were available to anyone who could pay for them.\nOnce the papers were published, FinFisher went back underground. The coders behind the program began to change its routines and filenames enough to let it slip by unnoticed. Soon, the servers weren\u2019t responding to the same call Marquis-Boire had sent out. They had new procedures now, new passwords, and they knew they were being watched. Marquis-Boire had gotten his glimpse of the network, but then it knew it had been spotted and sank back into the shadows.\nStill, Marquis-Boire\u2019s investigation had dug up enough for a definitive case that FinFisher had been used against Bahraini activists in London. That left two awkward possibilities: either the British government had approved FinFisher for export, or Gamma never reported the sale. The first option would mean messy publicity for UK officials, revealing that the government had facilitated the ongoing persecution of refugees. The second could be even worse, putting FinFisher and other programs directly in the crosshairs of British trade enforcers. And if Gamma violated the UK\u2019s hacking laws, the fallout could be even greater.\nIn August, the humanitarian rights group Bahrain Watch published new evidence suggesting that the Bahraini government had been using FinFisher to conduct surveillance on prominent Bahraini lawyers, activists, and politicians, both in Bahrain and abroad. According to information from a massive data leak, Gamma not only sold FinFisher to the Bahraini government, but actively worked with the regime to remotely access and monitor the computers and smartphones of opposition activists. (Gamma did not respond to multiple requests for comment.)\nIn the UK, Moosa Abd-Ali Ali was one of three Bahraini exiles allegedly targeted by the government, together with Jaffar Al Hasabi, 43, and Saeed Al-Shehabi, 60. The devices of all three men were infected in 2011, but the extent of the breach didn\u2019t become apparent until recently.\nGamma actively worked with the regime to access and monitor the activity of opposition activists\nMoosa, Jaffar, and Saeed represent three different generations of Bahraini activism, but they\u2019re all fighting the same fight. Jaffar, tall and soft-spoken, has devoted his life to campaigning against the widely documented human rights violations committed by the Bahraini government, and has been living in exile in London since the mid-1990s. Saeed, a London-educated engineer and prominent opposition figure, acts as the elder statesmen of the group, professorial and eloquent with thinning gray hair.\nAll three have been imprisoned and tortured in Bahrain \u2014 Jaffar as recently as 2010 \u2014 and all three have had their Bahraini citizenship revoked. In London, they\u2019re part of a tight-knit community of Bahraini activists who orchestrate protests, petitions, and other events to raise awareness about the ruling family\u2019s abuses and what they see as tacit complicity on the part of the British government.\nEven in the UK, Moosa and his compatriots are physically harassed by groups they believe are connected to the Bahraini regime. The three were attacked in an alleyway following a demonstration in 2009, the same year that arsonists laid siege to Saeed\u2019s house in the dead of night. But they never thought that a UK firm would actively work with the Bahraini government to monitor them in a country that was supposed to keep them safe.\n\"What we didn\u2019t expect is that they would go that far by really intruding into our private lives,\" Saeed says over tea at an Islamic charity he runs in central London.\nWary of endangering their families or other activists in Bahrain, the men have learned to keep politics out of their conversations and have curtailed their social media activity to varying degrees. \"We feel that we are not safe,\" Jaffar adds. \"It limits how we talk and what we can say.\"\nUsing FinFisher, the Bahraini government effectively undermined the asylum Moosa and his compatriots were granted in the UK \u2014 the kind of cautionary tale of corporate-state surveillance that has become increasingly common in recent years.\nUltimately, the men were lucky. FinFisher was detected and wiped from their devices, and a watchdog is pushing for an investigation on their behalf. But while Moosa and his friends recover, FinFisher is gathering new targets in new countries. Many of them may not be as lucky as Moosa.\n\"One, two, three, four, Al-Asoud, no more!\"\n\"Five, six, seven, eight, Saudi is a terror state!\"\nMoosa\u2019s voice bellows across the leafy streets of central London on a crisp November afternoon. His calls are echoed by Saeed, Jaffar, and three other Bahraini activists, all men. They\u2019ve come here to the upscale, commercial district of Mayfair to protest directly in front of the Saudi Arabian embassy, as they do every Wednesday afternoon between 2 and 3 PM. Saeed and Moosa each hold up two large banners urging the British government to \"stop supporting Bahrain\u2019s torturers\" and calling for Saudi troops to leave the island nation that they invaded following the Arab Spring. Jaffar patrols the sidewalk, handing out flyers with soft greetings.\nThe demonstration is short and non-eventful. Louis Vuitton-clad women politely decline or outright ignore Jaffar\u2019s extended hand, and the banners draw little more than passing interest and a few iPhone clicks. At precisely 3 PM, they pack up their things, under the watchful gaze of embassy guards across the street, and load them into a car with perfunctory swiftness.\nAfter the protest, the three men go their separate ways. The sun is weakening and traffic is snarling, but Moosa doesn\u2019t seem to be in much of a rush, munching potato chips in the back of a car as we lurch closer to his office near the King\u2019s Cross train station. Short and burly with a small mullet, Moosa has the build of a guy who carries heavy equipment all day. He\u2019s quiet and warm in person, but his friends describe him as a tour de force in London\u2019s activist community, his quick smile and soft dark eyes masking years of suffering.\n\"I was looking for someone to punch.\"\n\"In my opinion he\u2019s one of the bravest people,\" says Sayed Ahmed, director of advocacy at the London NGO Bahrain Institute for Rights and Democracy (BIRD), and a longtime friend of Moosa. \"Most victims, they want to forget what has happened to them, but Moosa is the kind of person \u2014 after what he went through, he only wanted to challenge it, to fight against it. He\u2019s so determined.\"\nOf the three London activists implicated by FinFisher, Moosa is likely the one with the most to lose. His work revolves around the flow of information and media. His WhatsApp conversations update faster than most people\u2019s Twitter feeds. Seated in front of an iMac in his agency\u2019s King\u2019s Cross office \u2014 a converted residence and occasional Islamic daycare that also houses BIRD \u2014 he eagerly clicks through the vast library of video footage he\u2019s collected over the years, stored across six different hard drives: protests, official Bahraini visits, parliamentary events. If there\u2019s a Bahrain-related happening in the UK, Moosa is there, camera in tow.\nMoosa was furious when he first realized his privacy had been compromised \u2014 \"I was looking for someone to punch\" \u2014 but he\u2019s not worried about the government meddling with his videos. He stores them on hard drives and immediately uploads footage to the web once he receives it. If anything, the FinFisher saga seems to have emboldened him.\nA video of Moosa confronting Tariq Alhasan, the official spokesperson of Bahrain's Ministry of Interior, and the rest of the Ministry's delegation in Geneva on June 19th, 2014.\nHe\u2019s now begun conducting his own form of surveillance, obsessively tracking the online itineraries of Bahraini authorities in the hopes of upstaging their events with high-profile demonstrations. He\u2019s shouted at ambassadors, waved banners in front of dignitaries, and even staged a demonstration directly in front of a seated Queen Elizabeth II \u2014 all in an effort to send a message to his compatriots back home.\n\"When you shout at them here, they feel small,\" Moosa says. \"When they are in Bahrain, they are bigger. If anyone talks to them, they are behind bars. But here in the UK, they can\u2019t arrest me.\"\n\"When you shout at them here, they feel small.\"\nThere\u2019s no indication that Bahraini authorities have used information gleaned from the activists\u2019 computers against anyone in their network back home, but the possibility weighs heavily. \"In private, with my family, I speak freely because\u2026 I don\u2019t involve them with politics,\" Jaffar says. \"But the other friends in Bahrain, we are afraid that they would be harmed or jailed. Because many people who [had] been in contact with us are in jail right now, and we fear for the safety of the others\u2026. There are many in Bahrain right now who are hiding, because they are wanted by the government.\"\nTheir primary concern stems not from what effect FinFisher could have on their activism, but from the specter of having their personal lives invaded \u2014 the same fundamental privacy concern behind much of the NSA surveillance controversies in the US. There are already signs that the Bahraini government has sought to discredit the activists online. In 2011, a link to a pornographic website appeared in Saeed\u2019s Twitter feed. He didn\u2019t post it and immediately deleted it, but the incident underscores a familiar tactic used to smear opposition figures. Mohamed Altajer, a Bahraini human rights lawyer who was also targeted by FinFisher, was blackmailed in 2011 with a video of him and his wife having sex. He received the video on the same day that authorities infected his computer, along with a threat to make it public unless he stopped defending activists.\nIn October, a London-based watchdog group called Privacy International filed a formal complaint with the UK\u2019s National Crime Agency against Gamma Group. The case was simple: a company had violated British hacking laws, breaking into phones and hijacking accounts. What was the government doing about it? The organization was joined in the suit by Moosa, Jaffar and Saeed, each man testifying to his own experience with digital tracking.\nThey brought evidence: Marquis-Boire\u2019s report showed how Gamma\u2019s malware had infiltrated the trio\u2019s phones, piping data back to Bahrain. New reports from Bahrain Watch and Wikileaks showed Gamma employees providing active technical support to Bahrain officials. It was easy to connect the dots from Moosa to Gamma to the Bahraini regime. The new complaint just made it official, charging the Bahraini government with violating UK hacking law and naming Gamma as an accessory.\nThe case was simple: a company had violated British hacking laws\nBut the international nature of the hack makes it legally complex: British-German software, sold to Bahraini police, who used it to spy on Bahraini exiles in London. It\u2019s too broad for local law enforcement and too small to warrant an international incident.\nIn the past, Gamma has deflected legal action, either by claiming it had nothing to do with FinFisher\u2019s installation or that the software had been pirated. This time, those denials won\u2019t work. But it\u2019s still unclear if, or how, British government will respond.\n\"The commercial surveillance industry continues to operate with impunity and little moral responsibility,\" Carly Nyst, Legal Director for Privacy International, said in an email. \"It is time for companies like Gamma to face the consequences of enabling repressive regimes through the sale of their technology.\"\nBill Marczak, a research fellow at CitizenLab and the co-founder of Bahrain Watch, calls FinFisher just the latest step in \"productized surveillance,\" an approach pioneered by companies like Gamma and Milan-based Hacking Team that aims to make digital intrusion as easy and full-service as any other government technology package.\n\"They actually have a system that the government buys, and they get the whole package,\" Marczak says. \"It\u2019s not just the code itself, it\u2019s the administration, the analysis, the support \u2014 the whole framework is provided.\"\nThat turns the same surveillance conducted by the NSA or GCHQ into a market product, available to the highest bidder with no questions asked. \"The value proposition is essentially: \u2018Activists in your country are giving you trouble? Well here\u2019s a product that will allow you to turn their cellphone or computer into basically a wiretap, a surveillance tool, and you can spy on everything they do,\u2019\" Marczak says. \"And I think governments are very attracted to that.\"\nThe EU added \"intrusion software\" to its list of export-controlled goods alongside nuclear reactors and anthrax spores\nAs for FinFisher, CitizenLab\u2019s research shows that the spyware is being used in new countries, suggesting that demand is growing. The organization regularly conducts probes for new FinFisher servers, and the latest results, to be released in a few months, will likely paint a sobering picture. \"It\u2019s hard to say whether the total number of customers has gone up, but my suspicion is yes, this has continued to spread,\" Marczak adds. \"More and more governments are seeking out this technology and using it.\" This past November, the EU added \"intrusion software\" like FinFisher to its list of explicitly export-controlled goods, alongside nuclear reactors and anthrax spores. But it\u2019s still unclear if the new measures will limit the program\u2019s dissemination.\nIn the meantime, Moosa and his compatriots say they\u2019ll continue fighting for change in Bahrain, even if that means having to look over their shoulder a few extra times. They\u2019ve been beaten, tortured, and terrorized by the country they still call home, but they remain undeterred, buoyed by the belief that a better Bahrain is always just around the corner.\n\"One day, when the revolution is over and the Khalifas are gone, I will take you to Bahrain, and I will show you where I worked and how to fish in Bahrain,\" Moosa said over the phone last month. It was the evening of December 21st, 2014 \u2014 eight years to the day since he fled his home for the UK \u2014 and he was reminiscing about the time he spent working in fish markets as a young man. The memories are distant now, buried by the years of struggle, but in his mind the Bahrain of his youth is as vivid as ever.\n\"It is so, so lovely,\" he said of the country that continues to haunt him. \"The sea is so nice.\"\nPhotography by Hal Shinnie\n","Title":"A Spy in the Machine | The Verge","Tags":["policy","features","long-reads","us-world","longform","tech"]}